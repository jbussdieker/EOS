////////////////////////////////////////////////////////////////////////////////
// $Id: tasks.h,v 1.3 2010/12/18 02:06:00 Ecco Exp $
//
// Author: Joshua Bussdieker
// E-Mail: jbussdieker@gmail.com
// Description:
////////////////////////////////////////////////////////////////////////////////
#ifndef _TASKS_H
#define _TASKS_H

////////////////////////////////////////////////////////////////////////////////
// Functions
////////////////////////////////////////////////////////////////////////////////
#include "fs.h"

////////////////////////////////////////////////////////////////////////////////
// Functions
////////////////////////////////////////////////////////////////////////////////
typedef struct ioreq_t
{
	fs_node_t *handle;
	void *buffer;
	unsigned long size;
	int intnum;
} ioreq_t;

typedef struct task_t
{
	void *esp;
	void *kstack;
	void *cr3;
	void *stackptr;
	void *kstackptr;
	char name[32];
	char curpath[FILENAME_MAX];
	ioreq_t *req;
	fs_node_t *node;
	struct task_t *next;
	int priority;
	int ticks;
} task_t;

extern task_t *curtask;

////////////////////////////////////////////////////////////////////////////////
// Functions
////////////////////////////////////////////////////////////////////////////////
task_t *task_create(void *entry, int pl, char *name, int ticks);
void task_scheduler();
void task_kill();
task_t *task_wake(int sleepint);
void task_debug();

#endif